orbs:
  slack: circleci/slack@4.1.1

commands:
  set_slack:
    steps:
      - run:
          name: Set Message Info
          when: always
          command: |
            SLACK_SUCCESS=$(cat .circleci/template/slack.json)
            echo "export SLACK_SUCCESS='${SLACK_SUCCESS}'" >> $BASH_ENV
            source $BASH_ENV

jobs:
  build:
    steps:
      - checkout
      - set_slack
      - slack/notify:
          event: pass
          template: SLACK_SUCCESS

workflows:
  version: 2
    build_and_test:
      jobs:
        - build
